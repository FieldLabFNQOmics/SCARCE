% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_variants.R
\name{plot_variants}
\alias{plot_variants}
\title{plot_variants.R}
\usage{
plot_variants(
  seurat_obj = NULL,
  cell_annotations = NULL,
  focus_celltype = NULL,
  file_prefix = NULL,
  input_files = NULL,
  search = NULL,
  n_variants = 20,
  search_col = "plot_ID",
  result_dir,
  plot_directory,
  plot_prefix,
  damaging = T,
  priority_only = T,
  pass_only = T,
  p_max = NULL,
  z_min = NULL,
  OR_min = NULL,
  min_varcount_total = 20,
  max_alt_portion_total = 0.5,
  topn_col = NULL,
  font_size_multiplyer = 1,
  umap_reduction = "umap",
  upset_n = 10,
  sankey_min_count = 10,
  run_barplot = T,
  run_upset = T,
  run_heatmap = T,
  run_umap = T,
  run_sankey = T,
  heatmap_anno = "padj",
  include_UMAP_ref = T
)
}
\arguments{
\item{seurat_obj}{Optional Seurat object containing a UMAP reduction and
cell metadata. If supplied, per-variant genotype/AF/DP/GQ columns are added
to \code{meta.data} (temporarily inside the function) and UMAP panels are saved.
If \code{NULL}, UMAP plots are skipped.}

\item{cell_annotations}{Named vector (length = number of cells) mapping barcode
(names) → cell-type (values). Required if seurat_obj not provided.}

\item{focus_celltype}{String matching a celltype annotation. Top enriched variants
will be chosen based on results for this celltype only}

\item{file_prefix}{Prefix used by \code{find_somatic_variants()}.
Used to locate \verb{*_summary_pass*.tsv}, \verb{*_genotypes.tsv}, and
\verb{*_variant_counts_per_celltype.tsv} inside \code{result_dir}.}

\item{input_files}{Optional vector of file paths if not searching with file_prefix. Must include \verb{*_summary_pass*.tsv}, \verb{*_genotypes.tsv}, and
\verb{*_variant_counts_per_celltype.tsv}files.}

\item{search}{Optional character vector of search terms/regex to select
variants of interest from the summary table. If \code{NULL}, the top \code{n_variants}
are chosen by \code{topn_col} after filtering.}

\item{n_variants}{Maximum number of variants to plot.}

\item{search_col}{Column name (in the summary TSV) to match \code{search} against
(regex). Common choices: \code{"plot_ID"}, \code{"variant"}, \code{"SYMBOL"}, etc.}

\item{result_dir}{Directory containing the TSV outputs from
\code{find_somatic_variants()} (summary, per-cell-type, genotypes, counts).}

\item{plot_directory}{Directory to write all figures (\verb{*.png}, \verb{*.html}).}

\item{plot_prefix}{Filename prefix for saved plots.}

\item{damaging}{Logical; when \code{TRUE}, keep only variants annotated as damaging
by SIFT/PolyPhen (strings containing \code{"Deleterious"} or \code{"damaging"}).}

\item{priority_only}{Logical; when \code{TRUE}, keep only variants with the priority flag.}

\item{pass_only}{Logical; when \code{TRUE}, keep only passing variants}

\item{p_max}{Optional adjusted p-value (BH) cutoff applied to per-cell-type
enrichment results when selecting/signalling significant variants.}

\item{z_min}{Optional minimum Z-score cutoff applied to per-cell-type
enrichment results when selecting/signalling significant variants.}

\item{OR_min}{Optional minimum odds ratio cutoff applied to per-cell-type
enrichment results when selecting/signalling significant variants.}

\item{min_varcount_total}{Minimum total mutant count (\verb{NGT \%in\% \{1,2\}} across all
cells) required for a variant to be plotted.}

\item{max_alt_portion_total}{Maximum allowed global mutant fraction
(\code{alt_cnt_total / data_cnt_total}) to keep (helps exclude ubiquitous/germline-like sites).}

\item{topn_col}{Column used to rank variants. If NULL (default) the row order of the cell-type
results files is used. Use \code{"p"} (ascending) or \code{"OR"}/\code{"Z_score"} (descending).}

\item{font_size_multiplyer}{Global multiplier for text sizes in UMAP panels;
useful when plotting many variants in grids.}

\item{umap_reduction}{Which reduction to use when generating UMAP plots. Usually either
"umap" for ADT-base clusters (default) or "umap.variants" for variant-based clusters}

\item{upset_n}{How many intersections should be displayed in Upset plot}

\item{sankey_min_count}{Controls the minimum set size to be displayed on Sankey plot}

\item{run_barplot}{Generate barplot (TRUE / FALSE)}

\item{run_upset}{Generate Upset plot (TRUE / FALSE)}

\item{run_heatmap}{Generate Heatmap (TRUE / FALSE)}

\item{run_umap}{Generate UMAP plots (TRUE / FALSE)}

\item{run_sankey}{Generate Sankey plots}

\item{heatmap_anno}{Which feature should be used to annotate the heatmap. Either "padj" or "OR"}

\item{include_UMAP_ref}{Include reference UMAP image in generate AF and NGT umaps? (TRUE / FALSE)}
}
\value{
Seurat object
}
\description{
Create variant visualisations from the outputs of \code{find_somatic_variants()}: a stacked bar chart of
mutant proportions per cell type, an UpSet co-occurrence plot (if ≥4
variants), per-variant UMAPs (NGT/AF/DP/GQ) over a Seurat embedding, and a
Sankey showing hierarchical co-occurrence across cells.
}
